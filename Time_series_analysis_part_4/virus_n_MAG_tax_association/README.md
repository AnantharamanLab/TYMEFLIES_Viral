

# Time-series analysis - Part 4 Virus and MAG taxa association analysis - plot virus and MAG association

Within this "virus_n_MAG_tax_association" folder, we provided the scripts to generate the virus and MAG association plots for Cyanobacteria, methanotroph, Nanopelagicales viruses and *ahbD*-containing viruses.



**Scripts for plotting virus and MAG association for Cyanobacteria viruses**

| Group                                   | Script                                                       | Remarks                                                      |
| --------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Cyanobiaceae virus and MAG plots        | 01.01.plot_mean_and_std.Cyanobiaceae_MAG.py                  | Plot the mean and standard deviation curves                  |
| Cyanobiaceae virus and MAG plots        | 01.02.plot_mean_and_std.psbA_containing_Cyanobiaceae_virus.py |                                                              |
| Cyanobiaceae virus and MAG plots        | 01.03.plot_mean_and_std.no_psbA_containing_Cyanobiaceae_virus.py |                                                              |
| Cyanobiaceae virus and MAG plots        | 01.04.plot_mean_and_std.Cyanobiaceae_virus_and_MAG.py        |                                                              |
| Microcystis virus and MAG plots         | 01.05.plot_mean_and_std.Microcystis_MAG.py                   |                                                              |
| Microcystis virus and MAG plots         | 01.06.plot_mean_and_std.psbA_containing_Microcystis_virus.py |                                                              |
| Microcystis virus and MAG plots         | 01.07.plot_mean_and_std.no_psbA_containing_Microcystis_virus.py |                                                              |
| Microcystis virus and MAG plots         | 01.08.plot_mean_and_std.Microcystis_virus_and_MAG.py         |                                                              |
| Planktothrix virus and MAG plots        | 01.09.plot_mean_and_std.Planktothrix_MAG.py                  |                                                              |
| Planktothrix virus and MAG plots        | 01.10.plot_mean_and_std.psbA_containing_Planktothrix_virus.py |                                                              |
| Planktothrix virus and MAG plots        | 01.11.plot_mean_and_std.no_psbA_containing_Planktothrix_virus.py |                                                              |
| Planktothrix virus and MAG plots        | 01.12.plot_mean_and_std.Planktothrix_virus_and_MAG.py        |                                                              |
| Cyanobacteria virus and MAG plots       | 01.13.plot_mean_and_std.all_Cyanobacteria_virus_and_MAG.py   | Plot the mean lines of all three group of Cyanobacteria viruses and MAGs (combining all 01.01 to 01.12 results) |
| Other Cyanobacteria virus and MAG plots | 01.14.plot_mean_and_std.Other_Cyanobacteria_MAG.py           | Other Cyanobacteria excluding the above three groups         |
| Other Cyanobacteria virus and MAG plots | 01.15.plot_mean_and_std.psbA_containing_Other_Cyanobacteria_virus.py |                                                              |
| Other Cyanobacteria virus and MAG plots | 01.16.plot_mean_and_std.no_psbA_containing_Other_Cyanobacteria_virus.py |                                                              |
| Other Cyanobacteria virus and MAG plots | 01.17.plot_mean_and_std.Other_Cyanobacteria_virus_and_MAG.py |                                                              |
| Cyanobacteria virus and MAG plots       | 01.18.plot_muller_plots_for_Cyanobacteria_virus_and_MAG.prepare_input_tables.py | Make muller plots to show changing trends of four Cyanobacteria groups |
| Cyanobacteria virus and MAG plots       | 01.19.plot_muller_plots_for_Cyanobacteria_virus_and_MAG.R    |                                                              |
| Cyanobiaceae virus and MAG plots        | 01.20.get_valid_pairs_for_virus_and_MAG_abundance.for_Cyanobiaceae.py | Get the pairs of corresponding virus and MAG                 |
| Cyanobiaceae virus and MAG plots        | 01.21.make_boxplot_of_virus_to_host_ratios.for_Cyanobiaceae.R | Generate boxplot representing the virus and MAG (host) abundance ratio |
| Microcystis virus and MAG plots         | 01.22.get_valid_pairs_for_virus_and_MAG_abundance.for_Microcystis.py |                                                              |
| Microcystis virus and MAG plots         | 01.23.make_boxplot_of_virus_to_host_ratios.for_Microcystis.R |                                                              |
| Planktothrix virus and MAG plots        | 01.24.get_valid_pairs_for_virus_and_MAG_abundance.for_Planktothrix.py |                                                              |
| Planktothrix virus and MAG plots        | 01.25.make_boxplot_of_virus_to_host_ratios.for_Planktothrix.R |                                                              |



**Scripts for plotting virus and MAG association for methanotroph viruses**

| Group                             | Script                                                       | Remarks                                                      |
| --------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Methylocystis virus and MAG plots | 02.01.plot_mean_and_std.Methylocystis_MAG.py                 | Plot the mean and standard deviation curves                  |
| Methylocystis virus and MAG plots | 02.02.plot_mean_and_std.pmoC_containing_Methylocystis_virus.py |                                                              |
| Methylocystis virus and MAG plots | 02.03.plot_mean_and_std.no_pmoC_containing_Methylocystis_virus.py |                                                              |
| Methylocystis virus and MAG plots | 02.04.plot_mean_and_std.Methylocystis_virus_and_MAG.py       |                                                              |
| UBA6136 virus and MAG plots       | 02.05.plot_mean_and_std.UBA6136_MAG.py                       |                                                              |
| UBA6136 virus and MAG plots       | 02.06.plot_mean_and_std.pmoC_containing_UBA6136_virus.py     |                                                              |
| UBA6136 virus and MAG plots       | 02.07.plot_mean_and_std.no_pmoC_containing_UBA6136_virus.py  |                                                              |
| UBA6136 virus and MAG plots       | 02.08.plot_mean_and_std.UBA6136_virus_and_MAG.py             |                                                              |
| Methylomonas virus and MAG plots  | 02.09.plot_mean_and_std.Methylomonas_MAG.py                  |                                                              |
| Methylomonas virus and MAG plots  | 02.10.plot_mean_and_std.pmoC_containing_Methylomonas_virus.py |                                                              |
| Methylomonas virus and MAG plots  | 02.11.plot_mean_and_std.no_pmoC_containing_Methylomonas_virus.py |                                                              |
| Methylomonas virus and MAG plots  | 02.12.plot_mean_and_std.Methylomonas_virus_and_MAG.py        |                                                              |
| UBA10906 virus and MAG plots      | 02.13.plot_mean_and_std.UBA10906_MAG.py                      |                                                              |
| UBA10906 virus and MAG plots      | 02.14.plot_mean_and_std.pmoC_containing_UBA10906_virus.py    |                                                              |
| UBA10906 virus and MAG plots      | 02.15.plot_mean_and_std.no_pmoC_containing_UBA10906_virus.py |                                                              |
| UBA10906 virus and MAG plots      | 02.16.plot_mean_and_std.UBA10906_virus_and_MAG.py            |                                                              |
| Methanotroph virus and MAG plots  | 02.17.plot_mean_and_std.all_Methanotroph_virus_and_MAG.py    | Plot the mean lines of all four genera of methanotroph viruses and MAGs (combining all 02.01 to 01.16 results) |
| Methylocystis virus and MAG plots | 02.18.get_valid_pairs_for_virus_and_MAG_abundance.for_Methylocystis.py | Get the pairs of corresponding virus and MAG                 |
| Methylocystis virus and MAG plots | 02.19.make_boxplot_of_virus_to_host_ratios.for_Methylocystis.R | Generate boxplot representing the virus and MAG (host) abundance ratio |
| UBA6136 virus and MAG plots       | 02.20.get_valid_pairs_for_virus_and_MAG_abundance.for_UBA6136.py |                                                              |
| UBA6136 virus and MAG plots       | 02.21.make_boxplot_of_virus_to_host_ratios.for_UBA6136.R     |                                                              |
| Methylomonas virus and MAG plots  | 02.22.get_valid_pairs_for_virus_and_MAG_abundance.for_Methylomonas.py |                                                              |
| Methylomonas virus and MAG plots  | 02.23.make_boxplot_of_virus_to_host_ratios.for_Methylomonas.R |                                                              |
| UBA10906 virus and MAG plots      | 02.24.get_valid_pairs_for_virus_and_MAG_abundance.for_UBA10906.py |                                                              |
| UBA10906 virus and MAG plots      | 02.25.make_boxplot_of_virus_to_host_ratios.for_UBA10906.R    |                                                              |



**Scripts for plotting virus and MAG association for Nanopelagicales viruses**

| Group                                     | Script                                                       | Remarks                                                      |
| ----------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Planktophila virus and MAG plots          | 03.01.plot_mean_and_std.Planktophila_MAG.py                  | Plot the mean and standard deviation curves                  |
| Planktophila virus and MAG plots          | 03.02.plot_mean_and_std.katG_containing_Planktophila_virus.py |                                                              |
| Planktophila virus and MAG plots          | 03.03.plot_mean_and_std.no_katG_containing_Planktophila_virus.py |                                                              |
| Planktophila virus and MAG plots          | 03.04.plot_mean_and_std.Planktophila_virus_and_MAG.py        |                                                              |
| Nanopelagicus virus and MAG plots         | 03.05.plot_mean_and_std.Nanopelagicus_MAG.py                 |                                                              |
| Nanopelagicus virus and MAG plots         | 03.06.plot_mean_and_std.katG_containing_Nanopelagicus_virus.py |                                                              |
| Nanopelagicus virus and MAG plots         | 03.07.plot_mean_and_std.no_katG_containing_Nanopelagicus_virus.py |                                                              |
| Nanopelagicus virus and MAG plots         | 03.08.plot_mean_and_std.Nanopelagicus_virus_and_MAG.py       |                                                              |
| Other_Nanopelagicales virus and MAG plots | 03.09.plot_mean_and_std.Other_Nanopelagicales_MAG.py         | Other Nanopelagicales excluding the above two genera         |
| Other_Nanopelagicales virus and MAG plots | 03.10.plot_mean_and_std.katG_containing_Other_Nanopelagicales_virus.py |                                                              |
| Other_Nanopelagicales virus and MAG plots | 03.11.plot_mean_and_std.no_katG_containing_Other_Nanopelagicales_virus.py |                                                              |
| Other_Nanopelagicales virus and MAG plots | 03.12.plot_mean_and_std.Other_Nanopelagicales_virus_and_MAG.py |                                                              |
| Nanopelagicales virus and MAG plots       | 03.13.plot_mean_and_std.all_Nanopelagicales_virus_and_MAG.py | Plot the mean lines of all two genera of Nanopelagicales viruses and MAGs (combining all 03.01 to 03.08 results) |
| Planktophila virus and MAG plots          | 03.14.get_valid_pairs_for_virus_and_MAG_abundance.for_Planktophila.py | Get the pairs of corresponding virus and MAG                 |
| Planktophila virus and MAG plots          | 03.15.make_boxplot_of_virus_to_host_ratios.for_Planktophila.R | Generate boxplot representing the virus and MAG (host) abundance ratio |
| Nanopelagicus virus and MAG plots         | 03.16.get_valid_pairs_for_virus_and_MAG_abundance.for_Nanopelagicus.py |                                                              |
| Nanopelagicus virus and MAG plots         | 03.17.make_boxplot_of_virus_to_host_ratios.for_Nanopelagicus.R |                                                              |



**Script for plotting virus abundance for ahbD-containing viruses**

Plot the mean and standard deviation curves of ahbD-containing viruses

[script] 04.01.plot_mean_and_std.ahbD_virus.py





